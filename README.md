# max480-random-stuff website

This is (part of) the source code for the max480-random-stuff.appspot.com website, a [Google App Engine](https://cloud.google.com/appengine/) app.

It contains the full source for:
- [the Everest Update Checker frontend service](https://max480-random-stuff.appspot.com/celeste/everest_update.yaml)
- [the Celeste custom entity catalog](https://max480-random-stuff.appspot.com/celeste/custom-entity-catalog)
- [the everest.yaml validator](https://max480-random-stuff.appspot.com/celeste/everest-yaml-validator)
- [the GameBanana search API](https://max480-random-stuff.appspot.com/celeste/gamebanana-search)

If you want to check how the update checker's everest_update.yaml file is generated, check [the Everest Update Checker Server repo](https://github.com/max4805/EverestUpdateCheckerServer) instead.

## The GameBanana search API

This API uses the mod search database generated by [the Everest Update Checker server](https://github.com/max4805/EverestUpdateCheckerServer) to find mods based on keywords. **This searches Celeste mods only**.

It is used by [Olympus](https://github.com/EverestAPI/Olympus) to search Celeste mods on GameBanana.

To use this API, call `https://max480-random-stuff.appspot.com/celeste/gamebanana-search?q=[search]`. The answer is in yaml format, and is a list of the top 20 matches. For example:

```
$ curl https://max480-random-stuff.appspot.com/celeste/gamebanana-search?q=spring+collab+2020
- {itemtype: Map, itemid: 211745}
- {itemtype: Gamefile, itemid: 13452}
- {itemtype: Map, itemid: 212317}
- {itemtype: Gamefile, itemid: 13185}
- {itemtype: Gui, itemid: 35325}
- {itemtype: Gamefile, itemid: 13258}
- {itemtype: Map, itemid: 212999}
- {itemtype: Gamefile, itemid: 12784}
- {itemtype: Gamefile, itemid: 9486}
```

Here the top 2 results are https://gamebanana.com/maps/211745 (The 2020 Celeste Spring Community Collab) and https://gamebanana.com/gamefiles/13452 (2020 Spring Collab Randomizer).

### How the search engine works

This search engine works with a pretty simple scoring system:
- if [something] matches the search exactly, it will get **4 points**.
- if the search is part of [something], it gets **3 points**.
- if [something] contains all the words in the search, it gets **1 point**.

[something] can be:
- the mod name: in this case, the bonus is **multiplied by 5**
- the mod authors: bonus **multiplied by 3**
- the description: bonus **multiplied by 2**
- the text: bonus **not multiplied**

Then the mods are sorted by score and the top 20 ones are returned.

For example, searching "**max480**" will have in its results:
- "**max480's Helping Hand**" with 24 points: title contains max480 (3 * 5 pts), authors contain max480 (3 * 3 pts)
- "**Safe Respawn Crumble & Crystal Bomb Detonator**" with 12 points: authors contain max480 (3 * 3 pts), text contains max480 (3 pts)

Searching "**Spring Collab 2020" will bring up**:
- "**The 2020 Celeste Spring Community Collab**" with 17 points: title contains "Spring", "Collab" and "2020" (1 * 5 pts), authors contain "Spring Collab 2020" (3 * 3 pts), text contains "Spring Collab 2020" (3 pts)
- "**2020 Spring Collab Randomizer**" with 15 points: title contains "Spring", "Collab" and "2020" (1 * 5 pts), authors contain "Spring Collab 2020" (3 * 3 pts), text contains "Spring", "Collab" and "2020" (1 pt)
